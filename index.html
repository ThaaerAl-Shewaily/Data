<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù…Ø§Ø±Ø© A409</title>
    <style>
        :root { --primary: #1a5276; --accent: #2980b9; --bg: #f0f4f7; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .card { background: white; width: 90%; max-width: 450px; padding: 2rem; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-top: 8px solid var(--primary); }
        .header { text-align: center; margin-bottom: 20px; }
        .header h1 { color: var(--primary); margin: 0; font-size: 1.6rem; }
        .info-box { background: #fff3cd; color: #856404; padding: 10px; border-radius: 8px; font-size: 0.85rem; margin-bottom: 20px; border: 1px solid #ffeeba; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: 600; color: #333; }
        select, input { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1rem; box-sizing: border-box; }
        input:read-only { background: #f8f9fa; color: #999; }
        button { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { background: var(--accent); }
        #msg { display: none; text-align: center; padding: 10px; margin-top: 15px; border-radius: 10px; background: #d4edda; color: #155724; font-weight: bold; }
    </style>
</head>
<body>

<div class="card">
    <div class="header">
        <h1>Ø§Ù„Ø¹Ù…Ø§Ø±Ø© A409</h1>
        <p>ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¨Ø§ÙŠØ© Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§Øª</p>
    </div>

    <div class="info-box">
        ØªÙ†Ø¨ÙŠÙ‡: Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù‚Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø§Ù„Ø³Ø¬Ù„ Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø± Ø§Ù„ØµÙÙˆÙ.
    </div>

    <form id="paymentForm">
        <div class="form-group">
            <label>Ø±Ù‚Ù… Ø§Ù„Ø´Ù‚Ø© (Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ 120)</label>
            <select name="Departments" id="aptSelect" required>
                <option value="" disabled selected>-- Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‚Ø© --</option>
            </select>
        </div>

        <div class="form-group">
            <label>Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹</label>
            <select name="status" id="statusSelect" required>
                <option value="" disabled selected>-- Ø§Ø®ØªØ± Ø§Ù„Ø­Ø§Ù„Ø© --</option>
                <option value="Ù…Ø³Ø¯Ø¯">âœ… Ù…Ø³Ø¯Ø¯</option>
                <option value="Ù…Ù…ØªÙ†Ø¹">âŒ Ù…Ù…ØªÙ†Ø¹</option>
                <option value="ØºÙŠØ± Ù…Ø­Ø¯Ø¯">ğŸ”„ Ø­Ø°Ù/Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</option>
            </select>
        </div>

        <div class="form-group">
            <label>Ø§Ù„Ù…Ø¨Ù„Øº</label>
            <input type="number" name="amount" id="amountInput" placeholder="0" required min="0">
        </div>

        <button type="submit" id="btnSubmit">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„</button>
    </form>

    <div id="msg">âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù‚Ø© Ø¨Ù†Ø¬Ø§Ø­!</div>
</div>

<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycby_LjuhoL2pjxCjT4fdQEDDGC-J_J7jn375z3H3mNupFLoNH4iBEGCV0hXBp7HzmcDL/exec';
    
    // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø´Ù‚Ù‚ (12 Ø£Ø±Ø¶ÙŠ + 9 Ø·ÙˆØ§Ø¨Ù‚ Ã— 12 Ø´Ù‚Ø© = 120 Ø´Ù‚Ø©)
    window.onload = function() {
        const aptSelect = document.getElementById('aptSelect');
        // Ø§Ù„Ø£Ø±Ø¶ÙŠ
        let gGroup = document.createElement('optgroup'); gGroup.label = "Ø§Ù„Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø£Ø±Ø¶ÙŠ";
        for (let i = 1; i <= 12; i++) {
            gGroup.innerHTML += `<option value="G${i}">Ø´Ù‚Ø© G${i}</option>`;
        }
        aptSelect.appendChild(gGroup);

        // Ø§Ù„Ø¹Ù„ÙˆÙŠØ©
        for (let f = 1; f <= 9; f++) {
            let group = document.createElement('optgroup'); group.label = `Ø§Ù„Ø·Ø§Ø¨Ù‚ ${f}`;
            for (let a = 1; a <= 12; a++) {
                let val = f + (a < 10 ? '0' + a : '' + a);
                group.innerHTML += `<option value="${val}">Ø´Ù‚Ø© ${val}</option>`;
            }
            aptSelect.appendChild(group);
        }
    };

    const statusSelect = document.getElementById('statusSelect');
    const amountInput = document.getElementById('amountInput');

    statusSelect.addEventListener('change', function() {
        if (this.value === "Ù…Ù…ØªÙ†Ø¹" || this.value === "ØºÙŠØ± Ù…Ø­Ø¯Ø¯") {
            amountInput.value = 0;
            amountInput.readOnly = true;
        } else {
            amountInput.value = "";
            amountInput.readOnly = false;
        }
    });

    document.getElementById('paymentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const btn = document.getElementById('btnSubmit');
        btn.disabled = true; btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...";

        fetch(scriptURL, { method: 'POST', body: new FormData(this)})
            .then(() => {
                document.getElementById('msg').style.display = "block";
                this.reset();
                amountInput.readOnly = false;
                btn.disabled = false; btn.innerText = "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„";
                setTimeout(() => { document.getElementById('msg').style.display = "none"; }, 4000);
            })
            .catch(() => { alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„"); btn.disabled = false; });
    });
</script>

</body>
</html>
